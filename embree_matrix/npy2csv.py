import numpy as np
import pandas as pd


# 示例数据生成
num_rays = 98
num_points = 1386260

# 行标题和列标题

column_titles = ['2024-06-20_05:15', '2024-06-20_05:30', '2024-06-20_05:45', '2024-06-20_06:00', '2024-06-20_06:15', '2024-06-20_06:30', '2024-06-20_06:45', '2024-06-20_07:00', '2024-06-20_07:15', '2024-06-20_07:30', '2024-06-20_07:45', '2024-06-20_08:00', '2024-06-20_08:15', '2024-06-20_08:30', '2024-06-20_08:45', '2024-06-20_09:00', '2024-06-20_09:15', '2024-06-20_09:30', '2024-06-20_09:45', '2024-06-20_10:00', '2024-06-20_10:15', '2024-06-20_10:30', '2024-06-20_10:45', '2024-06-20_11:00', '2024-06-20_11:15', '2024-06-20_11:30', '2024-06-20_11:45', '2024-06-20_12:00', '2024-06-20_12:15', '2024-06-20_12:30', '2024-06-20_12:45', '2024-06-20_13:00', '2024-06-20_13:15', '2024-06-20_13:30', '2024-06-20_13:45', '2024-06-20_14:00', '2024-06-20_14:15', '2024-06-20_14:30', '2024-06-20_14:45', '2024-06-20_15:00', '2024-06-20_15:15', '2024-06-20_15:30', '2024-06-20_15:45', '2024-06-20_16:00', '2024-06-20_16:15', '2024-06-20_16:30', '2024-06-20_16:45', '2024-06-20_17:00', '2024-06-20_17:15', '2024-06-20_17:30', '2024-06-20_17:45', '2024-06-20_18:00', '2024-06-20_18:15', '2024-06-20_18:30', '2024-06-20_18:45', '2024-06-20_19:00', '2024-06-20_19:15', '2024-06-20_19:30', '2024-06-20_19:45', '2024-06-20_20:00', '2024-06-20_20:15', '2024-06-20_20:30', '2024-06-20_20:45', '2024-06-20_21:00', '2024-06-20_21:15', '2024-06-20_21:30', '2024-06-20_21:45', '2024-12-21_08:30', '2024-12-21_08:45', '2024-12-21_09:00', '2024-12-21_09:15', '2024-12-21_09:30', '2024-12-21_09:45', '2024-12-21_10:00', '2024-12-21_10:15', '2024-12-21_10:30', '2024-12-21_10:45', '2024-12-21_11:00', '2024-12-21_11:15', '2024-12-21_11:30', '2024-12-21_11:45', '2024-12-21_12:00', '2024-12-21_12:15', '2024-12-21_12:30', '2024-12-21_12:45', '2024-12-21_13:00', '2024-12-21_13:15', '2024-12-21_13:30', '2024-12-21_13:45', '2024-12-21_14:00', '2024-12-21_14:15', '2024-12-21_14:30', '2024-12-21_14:45', '2024-12-21_15:00', '2024-12-21_15:15', '2024-12-21_15:30', '2024-12-21_15:45', '2024-12-21_16:00']


# 计算光线强度
intensity_matrix = np.load('intensity.npy')

# 转换为DataFrame
intensity_df = pd.DataFrame(intensity_matrix.T,  columns=column_titles)  # Transpose for correct shape

print(len(intensity_df))


# 指定要插入空行的索引位置
indices_to_insert = [442724, 442725, 442726, 442727, 816380, 1102633, 1102634, 1102635, 1124880, 1124985, 1124986, 1124987, 1124988, 1124989, 1124990, 1124991, 1124992, 1124993, 1302683, 1376613, 1376614, 1376615]

# 创建一个空的 DataFrame 用于插入空行
empty_rows = pd.DataFrame(np.nan, index=indices_to_insert, columns=intensity_df.columns)

# 合并原始 DataFrame 和空行 DataFrame
data_reindexed = pd.concat([intensity_df, empty_rows]).sort_index().reset_index(drop=True)


print(len(data_reindexed))

original_df = pd.read_csv('munich_trans_facade_samples.csv')
print(len(original_df))
combined_df = pd.concat([original_df, data_reindexed], axis=1)

# 保存到CSV文件
combined_df.to_csv('final_intensity.csv')

print("CSV文件已成功保存。")
